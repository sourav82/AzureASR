{
  "version": 4,
  "terraform_version": "1.3.2",
  "serial": 68,
  "lineage": "1ad4ffbb-db6c-670f-7f4c-f321e393a687",
  "outputs": {
    "resource_group_name": {
      "value": "",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "managed",
      "type": "azurerm_resource_group_policy_assignment",
      "name": "allvms",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "Virtual machines without disaster recovery configurations are vulnerable to outages and other disruptions. If the virtual machine does not already have disaster recovery configured, this would initiate the same by enabling replication using preset configurations to facilitate business continuity.  You can optionally include/exclude virtual machines containing a specified tag to control the scope of assignment. To learn more about disaster recovery, visit https://aka.ms/asr-doc.",
            "display_name": "Configure ASR for all VMs in the scope",
            "enforce": true,
            "id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke/providers/Microsoft.Authorization/policyAssignments/all-vm-asr",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "0092ef39-3738-42a4-bc5f-04e73625d747",
                "tenant_id": "87f8dbf6-2fd6-4cd9-9f2a-f7df0188991f",
                "type": "SystemAssigned"
              }
            ],
            "location": "uksouth",
            "metadata": "{\"createdBy\":\"9befd6c9-0d93-4c85-bb74-c1c33f24767a\",\"createdOn\":\"2022-10-08T15:10:30.6363932Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "all-vm-asr",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"cacheStorageAccountId\":{\"value\":\"/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke/providers/Microsoft.Storage/storageAccounts/bermudastorageasr\"},\"effect\":{\"value\":\"DeployIfNotExists\"},\"recoveryNetworkId\":{\"value\":\"/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke-ASR/providers/Microsoft.Network/virtualNetworks/Spoke-ASR-VNET\"},\"sourceRegion\":{\"value\":\"uksouth\"},\"targetRegion\":{\"value\":\"ukwest\"},\"targetResourceGroupId\":{\"value\":\"/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke-ASR\"},\"vaultId\":{\"value\":\"/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke-ASR/providers/Microsoft.RecoveryServices/vaults/RSV-UKW-DR\"},\"vaultResourceGroupId\":{\"value\":\"/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke-ASR\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac34a73f-9fa5-4067-9247-a3ecae514468",
            "resource_group_id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_site_recovery_replication_policy.asr-policy"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_resource_group_policy_remediation",
      "name": "allvms-remediate",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "failure_percentage": null,
            "id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke/providers/Microsoft.PolicyInsights/remediations/asr-policy-remediation",
            "location_filters": [
              "uksouth"
            ],
            "name": "asr-policy-remediation",
            "parallel_deployments": 0,
            "policy_assignment_id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourcegroups/spoke/providers/microsoft.authorization/policyassignments/all-vm-asr",
            "policy_definition_id": null,
            "policy_definition_reference_id": "",
            "resource_count": 0,
            "resource_discovery_mode": "ExistingNonCompliant",
            "resource_group_id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_resource_group_policy_assignment.allvms",
            "azurerm_role_assignment.roleAssignementLogAnalyticsContributor",
            "azurerm_role_assignment.roleAssignementLogAnalyticsContributor1",
            "azurerm_site_recovery_replication_policy.asr-policy"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "roleAssignementLogAnalyticsContributor",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke-ASR/providers/Microsoft.Authorization/roleAssignments/1620a2f7-3812-281d-b6fd-472b7cf5c56f",
            "name": "1620a2f7-3812-281d-b6fd-472b7cf5c56f",
            "principal_id": "0092ef39-3738-42a4-bc5f-04e73625d747",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke-ASR",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_resource_group_policy_assignment.allvms",
            "azurerm_site_recovery_replication_policy.asr-policy"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "roleAssignementLogAnalyticsContributor1",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke/providers/Microsoft.Authorization/roleAssignments/e17bda2c-fe15-53a5-7750-45309f6cb831",
            "name": "e17bda2c-fe15-53a5-7750-45309f6cb831",
            "principal_id": "0092ef39-3738-42a4-bc5f-04e73625d747",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_resource_group_policy_assignment.allvms",
            "azurerm_site_recovery_replication_policy.asr-policy"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_site_recovery_replication_policy",
      "name": "asr-policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_consistent_snapshot_frequency_in_minutes": 240,
            "id": "/subscriptions/e214bc97-a738-4d9b-9671-8444a7e1a720/resourceGroups/Spoke-ASR/providers/Microsoft.RecoveryServices/vaults/RSV-UKW-DR/replicationPolicies/asr-policy",
            "name": "asr-policy",
            "recovery_point_retention_in_minutes": 10080,
            "recovery_vault_name": "RSV-UKW-DR",
            "resource_group_name": "Spoke-ASR",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0="
        }
      ]
    }
  ],
  "check_results": []
}
